# ボード線図

import matplotlib.pyplot as plt
import numpy as np

# グラフの設定

# 日本語が文字化けしないようにフォントを設定
plt.rcParams["font.family"] = "Hiragino Sans"
# 内向き目盛り
plt.rcParams["xtick.direction"] = "in"
plt.rcParams["ytick.direction"] = "in"
# x軸のラベル, $\it{}$ とすると{}内の文字が斜体になる
plt.xlabel("周波数 $\it{f}$ / Hz")
# y軸のラベル
plt.ylabel("$\it{G}(\it{f})$ / dB")

plt.xscale("log")
plt.xlim(90, 110000)
plt.ylim(-40, 1)

# データ
x = np.array(
    [
        100,
        200,
        300,
        400,
        500,
        600,
        700,
        800,
        900,
        1000,
        2000,
        3000,
        4000,
        5000,
        6000,
        7000,
        8000,
        9000,
        10000,
        20000,
        30000,
        40000,
        50000,
        60000,
        70000,
        80000,
        90000,
        100000,
    ]
)

# 理論値
y1 = np.array(
    [
        0.05821655486,
        0.008710839304,
        -0.07256491931,
        -0.1838546896,
        -0.3228747789,
        -0.4869584123,
        -0.6732065309,
        -0.8786295183,
        -1.100268905,
        -1.335293102,
        -3.963977321,
        -6.411187223,
        -8.460777364,
        -10.17422022,
        -11.63069703,
        -12.89112792,
        -13.99924408,
        -14.98647424,
        -15.87581954,
        -21.81286877,
        -25.31904365,
        -27.81232742,
        -29.7479838,
        -31.33022624,
        -32.66832822,
        -33.8276259,
        -34.85030523,
        -35.76518955,
    ]
)

# 実験値
y2 = np.array(
    [
        0,
        -0.0740279166,
        -0.09884476102,
        -0.2114064612,
        -0.3509927903,
        -0.5975095651,
        -0.7301211431,
        -0.8919747015,
        -1.140554486,
        -1.425363268,
        -3.149086221,
        -6.912574615,
        -8.425692395,
        -10.13993466,
        -11.50523129,
        -12.79808799,
        -13.94262139,
        -14.70952123,
        -15.55074813,
        -21.42536327,
        -24.94718845,
        -27.44596318,
        -29.38416344,
        -30.96778836,
        -32.37940985,
        -33.46656309,
        -34.70952123,
        -35.40476335,
    ]
)

# 描画
plt.plot(x, y1, "kx--", label="理論値")
plt.plot(x, y2, "ko-", label="実験値")
plt.plot([1900, 1900], [1, -40], "r", lw=1)
plt.plot([90, 110000], [-3, -3], "r", lw=1)
plt.grid(which="both")
plt.legend(["理論値", "実験値"])
plt.show()
